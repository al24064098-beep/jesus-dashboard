<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CS3 CRM | Investor Relations</title>
    <link rel="stylesheet" href="style.css?v=3">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <span class="logo-icon">üè¢</span>
                    <span class="logo-text">CS3 CRM</span>
                </div>
                <span class="version">v3.0</span>
            </div>
            
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Overview</div>
                    <a href="#" class="nav-item active" data-page="dashboard">
                        <i class="fas fa-chart-line"></i>
                        <span>Dashboard</span>
                    </a>
                    <a href="#" class="nav-item" data-page="properties">
                        <i class="fas fa-building"></i>
                        <span>Properties</span>
                    </a>
                    <a href="#" class="nav-item" data-page="capital">
                        <i class="fas fa-hand-holding-usd"></i>
                        <span>Capital Raising</span>
                    </a>
                </div>
                
                <div class="nav-section">
                    <div class="nav-section-title">Investors</div>
                    <a href="#" class="nav-item" data-page="investors">
                        <i class="fas fa-users"></i>
                        <span>All Investors</span>
                        <span class="badge" id="investorCount">623</span>
                    </a>
                    <a href="#" class="nav-item" data-page="pipeline">
                        <i class="fas fa-filter"></i>
                        <span>Pipeline</span>
                    </a>
                    <a href="#" class="nav-item" data-page="communications">
                        <i class="fas fa-comments"></i>
                        <span>Communications</span>
                    </a>
                </div>
                
                <div class="nav-section">
                    <div class="nav-section-title">Operations</div>
                    <a href="#" class="nav-item" data-page="distributions">
                        <i class="fas fa-money-bill-wave"></i>
                        <span>Distributions</span>
                    </a>
                    <a href="#" class="nav-item" data-page="reports">
                        <i class="fas fa-file-alt"></i>
                        <span>Reports</span>
                    </a>
                    <a href="#" class="nav-item" data-page="tasks">
                        <i class="fas fa-tasks"></i>
                        <span>Tasks</span>
                        <span class="badge">5</span>
                    </a>
                </div>
            </nav>
            
            <div class="sidebar-footer">
                <div class="user-info">
                    <div class="user-avatar">AL</div>
                    <div class="user-details">
                        <span class="user-name">Al Liao</span>
                        <span class="user-role">Director of IR</span>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="header">
                <div class="header-left">
                    <div class="search-box">
                        <i class="fas fa-search"></i>
                        <input type="text" placeholder="Search investors, properties, deals..." id="globalSearch">
                    </div>
                </div>
                <div class="header-right">
                    <button class="header-btn" onclick="refreshData()">
                        <i class="fas fa-sync-alt"></i>
                        <span>Refresh</span>
                    </button>
                    <button class="header-btn primary" onclick="showAddInvestorModal()">
                        <i class="fas fa-plus"></i>
                        <span>Add Investor</span>
                    </button>
                </div>
            </header>

            <div class="page-content">
                <!-- DASHBOARD PAGE -->
                <div id="dashboard-page" class="page active">
                    <div class="page-header">
                        <h1>Dashboard</h1>
                        <p class="page-subtitle">Welcome back, Al! Here's your portfolio overview.</p>
                    </div>
                    
                    <!-- Stats Grid -->
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon teal"><i class="fas fa-users"></i></div>
                            <div class="stat-info">
                                <span class="stat-value" id="statInvestors">623</span>
                                <span class="stat-label">Total Investors</span>
                            </div>
                            <span class="stat-change positive">+12 this month</span>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon gold"><i class="fas fa-dollar-sign"></i></div>
                            <div class="stat-info">
                                <span class="stat-value" id="statAUM">$73.2M</span>
                                <span class="stat-label">Assets Under Management</span>
                            </div>
                            <span class="stat-change positive">+$2.1M this quarter</span>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon navy"><i class="fas fa-building"></i></div>
                            <div class="stat-info">
                                <span class="stat-value" id="statUnits">1,847</span>
                                <span class="stat-label">Units Managed</span>
                            </div>
                            <span class="stat-change neutral">6 properties</span>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon success"><i class="fas fa-chart-pie"></i></div>
                            <div class="stat-info">
                                <span class="stat-value" id="statDistributed">$3.98M</span>
                                <span class="stat-label">Total Distributed</span>
                            </div>
                            <span class="stat-change positive">Q4 complete</span>
                        </div>
                    </div>

                    <!-- Current Raise Quick View -->
                    <div class="capital-tracker">
                        <div class="tracker-header">
                            <div class="tracker-title">
                                <i class="fas fa-rocket"></i>
                                <h3>Current Capital Raise: Winding Springs</h3>
                            </div>
                            <button class="btn btn-outline btn-small" onclick="navigateTo('capital')">View Details ‚Üí</button>
                        </div>
                        
                        <div class="tracker-progress">
                            <div class="progress-bar-container">
                                <div class="progress-bar-fill" id="raiseProgress" style="width: 68%"></div>
                            </div>
                            <div class="progress-labels">
                                <span>$0</span>
                                <span id="raiseProgressText">68% Complete</span>
                                <span id="raiseGoalText">$10M Goal</span>
                            </div>
                        </div>
                        
                        <div class="tracker-stats">
                            <div class="tracker-stat goal">
                                <span class="tracker-stat-value" id="goalAmount">$10.0M</span>
                                <span class="tracker-stat-label">üéØ Goal</span>
                            </div>
                            <div class="tracker-stat committed">
                                <span class="tracker-stat-value" id="committedAmount">$7.8M</span>
                                <span class="tracker-stat-label">üìù Committed</span>
                            </div>
                            <div class="tracker-stat collected">
                                <span class="tracker-stat-value" id="collectedAmount">$6.8M</span>
                                <span class="tracker-stat-label">üí∞ Collected</span>
                            </div>
                            <div class="tracker-stat remaining">
                                <span class="tracker-stat-value" id="remainingAmount">$3.2M</span>
                                <span class="tracker-stat-label">üìä Remaining</span>
                            </div>
                        </div>
                    </div>

                    <!-- Properties Quick View -->
                    <div class="card">
                        <div class="card-header">
                            <h3><i class="fas fa-building"></i> Properties Overview</h3>
                            <button class="btn-text" onclick="navigateTo('properties')">View All ‚Üí</button>
                        </div>
                        <div class="card-body">
                            <div class="properties-grid" id="dashboardProperties">
                                <!-- Populated by JS -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- PROPERTIES PAGE -->
                <div id="properties-page" class="page">
                    <div class="page-header">
                        <h1>Properties</h1>
                        <p class="page-subtitle">All CS3 Investment properties - past and current</p>
                    </div>

                    <!-- Properties Filter -->
                    <div style="display: flex; gap: 12px; margin-bottom: 24px;">
                        <button class="btn btn-primary property-filter active" data-filter="all">All Properties</button>
                        <button class="btn btn-outline property-filter" data-filter="raising">Currently Raising</button>
                        <button class="btn btn-outline property-filter" data-filter="active">Active (Held)</button>
                        <button class="btn btn-outline property-filter" data-filter="exited">Exited</button>
                    </div>

                    <!-- Properties Grid -->
                    <div class="properties-grid" id="propertiesGrid">
                        <!-- Populated by JS -->
                    </div>
                </div>

                <!-- CAPITAL RAISING PAGE -->
                <div id="capital-page" class="page">
                    <div class="page-header">
                        <h1>Capital Raising Tracker</h1>
                        <p class="page-subtitle">Track capital commitments, collections, and funding sources</p>
                    </div>

                    <!-- Deal Selector -->
                    <div style="margin-bottom: 24px;">
                        <select id="dealSelector" class="form-input" style="max-width: 300px;" onchange="loadDealData()">
                            <option value="winding-springs">Winding Springs (Currently Raising)</option>
                            <option value="gateway-village">Gateway Village (Coming Soon)</option>
                            <option value="reserve">The Reserve at Cool Springs (Complete)</option>
                            <option value="legacy">Legacy Townhomes (Complete)</option>
                            <option value="mckenzie">McKenzie STL (Complete)</option>
                        </select>
                    </div>

                    <!-- Capital Tracker -->
                    <div class="capital-tracker">
                        <div class="tracker-header">
                            <div class="tracker-title">
                                <i class="fas fa-chart-line"></i>
                                <h3 id="dealName">Winding Springs Capital Raise</h3>
                            </div>
                            <span class="property-status raising" id="dealStatus">üü° Raising</span>
                        </div>
                        
                        <div class="tracker-progress">
                            <div class="progress-bar-container">
                                <div class="progress-bar-fill" id="capitalProgress" style="width: 68%"></div>
                            </div>
                            <div class="progress-labels">
                                <span>$0</span>
                                <span id="capitalProgressText">68% of Goal</span>
                                <span id="capitalGoalText">$10M Goal</span>
                            </div>
                        </div>
                        
                        <div class="tracker-stats">
                            <div class="tracker-stat goal">
                                <span class="tracker-stat-value" id="capitalGoal">$10.0M</span>
                                <span class="tracker-stat-label">üéØ Raise Goal</span>
                            </div>
                            <div class="tracker-stat committed">
                                <span class="tracker-stat-value" id="capitalCommitted">$7.8M</span>
                                <span class="tracker-stat-label">üìù Total Committed</span>
                            </div>
                            <div class="tracker-stat collected">
                                <span class="tracker-stat-value" id="capitalCollected">$6.8M</span>
                                <span class="tracker-stat-label">üí∞ Funds Collected</span>
                            </div>
                            <div class="tracker-stat remaining">
                                <span class="tracker-stat-value" id="capitalRemaining">$3.2M</span>
                                <span class="tracker-stat-label">üìä Still Needed</span>
                            </div>
                        </div>

                        <!-- Capital Breakdown -->
                        <h4 style="margin: 30px 0 20px; color: var(--cs3-teal-dark);"><i class="fas fa-pie-chart"></i> Capital Source Breakdown</h4>
                        <div class="capital-breakdown">
                            <div class="breakdown-card">
                                <h4><i class="fas fa-piggy-bank" style="color: var(--cs3-teal);"></i> Retirement Accounts (SDIRA/401k)</h4>
                                <div class="breakdown-amounts">
                                    <span class="breakdown-main" id="retirementAmount">$2.4M</span>
                                    <span class="breakdown-detail" id="retirementDetail">35% of collected ‚Ä¢ 18 investors</span>
                                </div>
                            </div>
                            <div class="breakdown-card">
                                <h4><i class="fas fa-money-bill-wave" style="color: var(--success);"></i> Cash / Wire Transfers</h4>
                                <div class="breakdown-amounts">
                                    <span class="breakdown-main" id="cashAmount">$4.4M</span>
                                    <span class="breakdown-detail" id="cashDetail">65% of collected ‚Ä¢ 42 investors</span>
                                </div>
                            </div>
                        </div>

                        <!-- Investors in this raise -->
                        <h4 style="margin: 30px 0 20px; color: var(--cs3-teal-dark);"><i class="fas fa-users"></i> Investors in This Raise</h4>
                        <div class="card">
                            <table class="data-table" id="raiseInvestorsTable">
                                <thead>
                                    <tr>
                                        <th>Investor</th>
                                        <th>Amount</th>
                                        <th>Type</th>
                                        <th>Status</th>
                                        <th>Committed Date</th>
                                        <th>Funded Date</th>
                                    </tr>
                                </thead>
                                <tbody id="raiseInvestorsList">
                                    <!-- Populated by JS -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- INVESTORS PAGE -->
                <div id="investors-page" class="page">
                    <div class="page-header">
                        <h1>Investors</h1>
                        <p class="page-subtitle">Manage all investor relationships</p>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3><i class="fas fa-users"></i> All Investors</h3>
                            <button class="btn btn-primary btn-small" onclick="showAddInvestorModal()">
                                <i class="fas fa-plus"></i> Add Investor
                            </button>
                        </div>
                        <div class="card-body">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Email</th>
                                        <th>Total Invested</th>
                                        <th>Properties</th>
                                        <th>Type</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="allInvestorsList">
                                    <!-- Populated by JS -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- PIPELINE PAGE -->
                <div id="pipeline-page" class="page">
                    <div class="page-header">
                        <h1>Investor Pipeline</h1>
                        <p class="page-subtitle">Track prospects through the investment journey</p>
                    </div>
                    
                    <div style="display: flex; gap: 20px; overflow-x: auto; padding-bottom: 20px;">
                        <div class="card" style="min-width: 280px; flex: 1;">
                            <div class="card-header" style="background: var(--bg-primary);">
                                <h3 style="font-size: 14px;">üéØ Lead</h3>
                                <span class="badge">12</span>
                            </div>
                            <div class="card-body" id="pipelineLeads"></div>
                        </div>
                        <div class="card" style="min-width: 280px; flex: 1;">
                            <div class="card-header" style="background: var(--bg-primary);">
                                <h3 style="font-size: 14px;">üìû Engaged</h3>
                                <span class="badge">8</span>
                            </div>
                            <div class="card-body" id="pipelineEngaged"></div>
                        </div>
                        <div class="card" style="min-width: 280px; flex: 1;">
                            <div class="card-header" style="background: var(--bg-primary);">
                                <h3 style="font-size: 14px;">üìù Committed</h3>
                                <span class="badge">5</span>
                            </div>
                            <div class="card-body" id="pipelineCommitted"></div>
                        </div>
                        <div class="card" style="min-width: 280px; flex: 1;">
                            <div class="card-header" style="background: rgba(16,185,129,0.1);">
                                <h3 style="font-size: 14px;">üí∞ Funded</h3>
                                <span class="badge">3</span>
                            </div>
                            <div class="card-body" id="pipelineFunded"></div>
                        </div>
                    </div>
                </div>

                <!-- COMMUNICATIONS PAGE -->
                <div id="communications-page" class="page">
                    <div class="page-header">
                        <h1>Communications</h1>
                        <p class="page-subtitle">Track all investor communications</p>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3><i class="fas fa-comments"></i> Recent Communications</h3>
                        </div>
                        <div class="card-body">
                            <p style="color: var(--text-secondary);">Communications tracking coming soon...</p>
                        </div>
                    </div>
                </div>

                <!-- DISTRIBUTIONS PAGE -->
                <div id="distributions-page" class="page">
                    <div class="page-header">
                        <h1>Distributions</h1>
                        <p class="page-subtitle">Track and manage investor distributions</p>
                    </div>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon gold"><i class="fas fa-money-bill-wave"></i></div>
                            <div class="stat-info">
                                <span class="stat-value">$2.8M</span>
                                <span class="stat-label">Q4 2025 Total</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon teal"><i class="fas fa-users"></i></div>
                            <div class="stat-info">
                                <span class="stat-value">623</span>
                                <span class="stat-label">Investors Paid</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon success"><i class="fas fa-check-circle"></i></div>
                            <div class="stat-info">
                                <span class="stat-value">100%</span>
                                <span class="stat-label">On-Time Rate</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon navy"><i class="fas fa-percentage"></i></div>
                            <div class="stat-info">
                                <span class="stat-value">7.2%</span>
                                <span class="stat-label">Avg CoC Return</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- REPORTS PAGE -->
                <div id="reports-page" class="page">
                    <div class="page-header">
                        <h1>Reports</h1>
                        <p class="page-subtitle">Analytics and performance metrics</p>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3><i class="fas fa-chart-bar"></i> Reports</h3>
                        </div>
                        <div class="card-body">
                            <p style="color: var(--text-secondary);">Detailed reports coming soon...</p>
                        </div>
                    </div>
                </div>

                <!-- TASKS PAGE -->
                <div id="tasks-page" class="page">
                    <div class="page-header">
                        <h1>Tasks</h1>
                        <p class="page-subtitle">Your action items and follow-ups</p>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3><i class="fas fa-tasks"></i> Today's Tasks</h3>
                        </div>
                        <div class="card-body" id="tasksList">
                            <p style="color: var(--text-secondary);">Task management coming soon...</p>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Add Investor Modal -->
    <div id="addInvestorModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add New Investor</h3>
                <button onclick="closeModal('addInvestorModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Full Name *</label>
                    <input type="text" class="form-input" id="investorName" placeholder="John Smith">
                </div>
                <div class="form-group">
                    <label class="form-label">Email *</label>
                    <input type="email" class="form-input" id="investorEmail" placeholder="john@example.com">
                </div>
                <div class="form-group">
                    <label class="form-label">Phone</label>
                    <input type="tel" class="form-input" id="investorPhone" placeholder="(555) 123-4567">
                </div>
                <div class="form-group">
                    <label class="form-label">Investment Type</label>
                    <select class="form-input" id="investorType">
                        <option value="cash">Cash / Wire</option>
                        <option value="sdira">SDIRA</option>
                        <option value="solo401k">Solo 401k</option>
                        <option value="entity">LLC/Entity</option>
                    </select>
                </div>
                <button class="btn btn-primary" style="width: 100%;" onclick="addInvestor()">
                    <i class="fas fa-plus"></i> Add Investor
                </button>
            </div>
        </div>
    </div>

    <style>
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        .modal-content {
            background: white;
            border-radius: 16px;
            width: 100%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
        }
        .modal-header {
            padding: 20px 24px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .modal-header h3 {
            font-size: 18px;
            font-weight: 600;
        }
        .modal-header button {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--text-secondary);
        }
        .modal-body {
            padding: 24px;
        }
    </style>

    <script src="app.js?v=3"></script>
</body>
</html>
